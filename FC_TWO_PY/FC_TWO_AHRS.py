from decimal import *
from FC_TWO_SEN_N2.mpu9250 import *
from FC_TWO_SEN_N2.lsm9ds1 import *
from FC_TWO_SEN_N2.util import *
from socket import *
from sys import *
import time as tv

check_apm()

G_SI = 9.80665
PI = 3.14159


# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████
#
#  ██████  ██████       ██ ███████  ██████ ████████ ███████
# ██    ██ ██   ██      ██ ██      ██         ██    ██
# ██    ██ ██████       ██ █████   ██         ██    ███████
# ██    ██ ██   ██ ██   ██ ██      ██         ██         ██
#  ██████  ██████   █████  ███████  ██████    ██    ███████
#
# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████

imu = MPU9250()   # MPU9250
ahrs = AHRS()     # Mahony AHRS

# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████
#
# ███████ ███████ ███    ██ ███████  ██████  ██████      ██████   █████  ████████  █████
# ██      ██      ████   ██ ██      ██    ██ ██   ██     ██   ██ ██   ██    ██    ██   ██
# ███████ █████   ██ ██  ██ ███████ ██    ██ ██████      ██   ██ ███████    ██    ███████
#      ██ ██      ██  ██ ██      ██ ██    ██ ██   ██     ██   ██ ██   ██    ██    ██   ██
# ███████ ███████ ██   ████ ███████  ██████  ██   ██     ██████  ██   ██    ██    ██   ██
#
# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████

# AccX, AccY, AccZ
# GyrX, GyrY, GyrZ
# MagX, MagY, MagZ

# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████
#
#  ██████  ██████  ██ ███████ ███    ██ ████████  █████  ████████ ██  ██████  ███    ██     ██████   █████  ████████  █████
# ██    ██ ██   ██ ██ ██      ████   ██    ██    ██   ██    ██    ██ ██    ██ ████   ██     ██   ██ ██   ██    ██    ██   ██
# ██    ██ ██████  ██ █████   ██ ██  ██    ██    ███████    ██    ██ ██    ██ ██ ██  ██     ██   ██ ███████    ██    ███████
# ██    ██ ██   ██ ██ ██      ██  ██ ██    ██    ██   ██    ██    ██ ██    ██ ██  ██ ██     ██   ██ ██   ██    ██    ██   ██
#  ██████  ██   ██ ██ ███████ ██   ████    ██    ██   ██    ██    ██  ██████  ██   ████     ██████  ██   ██    ██    ██   ██
#
# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████

# Roll, Pitch, Yaw

# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████
#
# ████████ ██ ███    ███ ██ ███    ██  ██████      ██████   █████  ████████  █████
#    ██    ██ ████  ████ ██ ████   ██ ██           ██   ██ ██   ██    ██    ██   ██
#    ██    ██ ██ ████ ██ ██ ██ ██  ██ ██   ███     ██   ██ ███████    ██    ███████
#    ██    ██ ██  ██  ██ ██ ██  ██ ██ ██    ██     ██   ██ ██   ██    ██    ██   ██
#    ██    ██ ██      ██ ██ ██   ████  ██████      ██████  ██   ██    ██    ██   ██
#
# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████

offset = [3]
# dt, maxdt
mindt = 0.01
# previoustime, currenttime
dtsumm = 0
isFirst = 1

# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████
#
# ███    ██ ███████ ████████ ██     ██  ██████  ██████  ██   ██     ██████   █████  ████████  █████
# ████   ██ ██         ██    ██     ██ ██    ██ ██   ██ ██  ██      ██   ██ ██   ██    ██    ██   ██
# ██ ██  ██ █████      ██    ██  █  ██ ██    ██ ██████  █████       ██   ██ ███████    ██    ███████
# ██  ██ ██ ██         ██    ██ ███ ██ ██    ██ ██   ██ ██  ██      ██   ██ ██   ██    ██    ██   ██
# ██   ████ ███████    ██     ███ ███   ██████  ██   ██ ██   ██     ██████  ██   ██    ██    ██   ██
#
# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████

# sockfd
# struct sockaddr_in servaddr = {0};
# sendline[80]

# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████
#
# ██ ███    ██ ██ ████████ ██  █████  ██          ███████ ███████ ████████ ██    ██ ██████
# ██ ████   ██ ██    ██    ██ ██   ██ ██          ██      ██         ██    ██    ██ ██   ██
# ██ ██ ██  ██ ██    ██    ██ ███████ ██          ███████ █████      ██    ██    ██ ██████
# ██ ██  ██ ██ ██    ██    ██ ██   ██ ██               ██ ██         ██    ██    ██ ██
# ██ ██   ████ ██    ██    ██ ██   ██ ███████     ███████ ███████    ██     ██████  ██
#
# ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████


def imuSetup():

    # ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████
    #
    # ███    ███ ██████  ██    ██     ██ ███    ██ ██ ████████ ██  █████  ██      ██ ███████  █████  ████████ ██  ██████  ███    ██
    # ████  ████ ██   ██ ██    ██     ██ ████   ██ ██    ██    ██ ██   ██ ██      ██    ███  ██   ██    ██    ██ ██    ██ ████   ██
    # ██ ████ ██ ██████  ██    ██     ██ ██ ██  ██ ██    ██    ██ ███████ ██      ██   ███   ███████    ██    ██ ██    ██ ██ ██  ██
    # ██  ██  ██ ██      ██    ██     ██ ██  ██ ██ ██    ██    ██ ██   ██ ██      ██  ███    ██   ██    ██    ██ ██    ██ ██  ██ ██
    # ██      ██ ██       ██████      ██ ██   ████ ██    ██    ██ ██   ██ ███████ ██ ███████ ██   ██    ██    ██  ██████  ██   ████
    #
    # ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████ ███████

    imu.initialize()

    print("Beginning Gyro calibration...\n")

    for i in range(100):
        x = imu.getMotion6()[0]
        print(x)
